<div class="form-container">
  <div class="back-link">
    <a routerLink="/associations" class="back-button">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
      Retour à la liste
    </a>
  </div>
  <form (ngSubmit)="onSubmit()" #orgForm="ngForm">
    <div class="form-section card-style">
      <h2 class="section-title">Informations générales</h2>
      <div class="row">
        <div class="col-6">
          <label for="nomAssoc">Nom de l'association </label>
          <input type="text" id="nomAssoc" [(ngModel)]="nouvelleAssociation.name" name="nomAssoc" required>
        </div>
        <div class="col-6">
          <label for="typeOrg">Type d'Association </label>
          <select id="typeOrg" [(ngModel)]="nouvelleAssociation.categorie" name="typeOrg" required>
            <option value="" disabled>Sélectionnez un type</option>
            @for (type of assoTypes; track type) {
              <option [value]="type">{{ type }}</option>
            }
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <label for="description">Description / Mission </label>
          <textarea id="description" [(ngModel)]="nouvelleAssociation.description" name="description" rows="4" placeholder="Décrivez la mission et les objectifs de votre association" required></textarea>
        </div>
      </div>

      <div class="row logo-upload">
        <label>Logo</label>
        <div class="logo-preview">
          <div class="preview-box">
            <span *ngIf="!nouvelleAssociation.logoUrl">Aucun logo</span>
            <img *ngIf="nouvelleAssociation.logoUrl" [src]="fichier" alt="Logo preview"> </div>
          <div class="file-input-wrapper">
            <input type="file" id="logo" (change)="onFileChange($event)" accept="image/png, image/jpeg, image/gif" style="display: none;">
            <button type="button" onclick="document.getElementById('logo').click()">Choisir un fichier</button>
            <small>PNG, JPG ou GIF. Taille maximale de 2 Mo.</small>
          </div>
        </div>
      </div>
    </div>

    <div class="form-section card-style">
      <h2 class="section-title">Coordonnées</h2>

      <div class="row">
        <div class="col-6">
          <label for="email">Email</label>
          <input type="email" id="email" [(ngModel)]="nouvelleAssociation.email" name="email">
        </div>
        <div class="col-6">
          <label for="tel">Téléphone</label>
          <input type="tel" id="tel" [(ngModel)]="nouvelleAssociation.phone" name="tel" required>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <label for="siteWeb">Site web</label>
          <input type="url" id="siteWeb" [(ngModel)]="nouvelleAssociation.siteWeb" name="siteWeb" placeholder="https://">
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <label for="adresse">Adresse </label>
          <input type="text" id="adresse" [(ngModel)]="nouvelleAssociation.address" name="adresse" required>
        </div>
      </div>

      <div class="row">
        <div class="col-4">
          <label for="ville">Ville </label>
          <input type="text" id="ville" [(ngModel)]="nouvelleAssociation.ville" name="ville" required>
        </div>
        <div class="col-4">
          <label for="codePostal">Code postal</label>
          <input type="text" id="codePostal" [(ngModel)]="nouvelleAssociation.codePostal" name="codePostal">
        </div>
        <div class="col-4">
          <label for="pays">Pays </label>
          <input type="text" id="pays" [(ngModel)]="nouvelleAssociation.pays" name="pays" required value="Mali">
        </div>
      </div>
    </div>

    <div class="form-section card-style">
      <h2 class="section-title">Représentant légal</h2>

      <div class="row">
        <div class="col-6">
          <label for="nomRep">Nom complet </label>
          <input type="text" id="nomRep" [(ngModel)]="nouvelleAssociation.nomComplet" name="nomRep" required>
        </div>
        <div class="col-6">
          <label for="fonctionRep">Fonction </label>
          <input type="text" id="fonctionRep" [(ngModel)]="nouvelleAssociation.fonction" name="fonctionRep" placeholder="Président, Secrétaire, etc." required>
        </div>
      </div>

      <!-- <div class="row">
        <div class="col-6">
          <label for="emailRep">Email</label>
          <input type="email" id="emailRep" [(ngModel)]="nouvelleAssociation.email" name="emailRep" >
        </div>
        <div class="col-6">
          <label for="telRep">Téléphone </label>
          <input type="tel" id="telRep" [(ngModel)]="nouvelleAssociation.telephoneR" name="telRep" required>
        </div>
      </div> -->
    </div>

    <div class="form-section card-style">
      <h2 class="section-title">Informations administratives</h2>

      <div class="row">
        <div class="col-6">
          <label for="numEnreg">Numéro d'enregistrement </label>
          <input type="text" id="numEnreg" [(ngModel)]="nouvelleAssociation.numeroEnregistrement" name="numEnreg" required>
        </div>
        <div class="col-6 date-field">
          <label for="dateCreation">Date de création </label>
          <div class="input-with-icon">
            <input type="text" id="dateCreation" [(ngModel)]="nouvelleAssociation.dateCreation" name="dateCreation" placeholder="mm/dd/yyyy"  disabled="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          </div>
        </div>
      </div>

      <!-- <div class="row">
        <div class="col-6">
          <label for="statut">Statut</label>
          <select id="statut" [(ngModel)]="nouvelleAssociation.statut" name="statut">
            <option value="En attente">En attente</option>
            <option value="Approuvé">Approuvé</option>
            <option value="Rejeté">Rejeté</option>
          </select>
        </div>
      </div> -->

      <div class="row checkbox-row">
        <input
          type="checkbox"
          id="confirmation"
          [(ngModel)]="nouvelleAssociation.confirmationOfficielle"
          name="confirmation"
          required
          class="custom-checkbox"
        >
        <label for="confirmation">Je confirme que toutes les informations fournies sont exactes et conformes aux documents officiels.</label>
      </div>

    </div>

    <div class="form-footer">
      <button type="button" class="btn-secondary" (click)="annuler()">Annuler</button>
      <button type="submit" class="btn-primary" [disabled]="orgForm.invalid">
        @if(isEditMode){
        Enregistrer les modifications
        } @else {
        Enregistrer
        }
      </button>
    </div>
  </form>
</div>
